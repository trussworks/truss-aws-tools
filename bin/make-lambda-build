#!/usr/bin/env bash

set -eux -o pipefail

readonly build_dir=$(mktemp -d)
readonly lambda_tools="rds-snapshot-cleaner trusted-advisor-refresh"
mkdir -p "$build_dir"

for cmd in $lambda_tools
do
    cmd_name=$(basename "$cmd")
    GOOS=linux go build -o "$build_dir/$cmd_name" ./cmd/"$cmd_name"
done

zip -j truss-aws-tools.zip "$build_dir"/*
rm -rf "$build_dir"
